<!DOCTYPE html>
<html lang="en">

    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0">
        <meta http-equiv="X-UA-Compatible" content="ie=edge">
        <link rel="stylesheet" href="src/css/normalize.css">
        <link rel="stylesheet" href="src/css/slide.css">

        <title>Slide Display</title>
    </head>
    <header>
        <p>Click on image to return to index</p>
    </header>

    <body>
        <div id="display"></div>
    </body>
    <template id="slide-display">
        <div class="slide-container">
            <p></p>
            <figure>
                <a href="index.html"><img></a>
                <figcaption></figcaption>
            </figure>
        </div>
    </template>
    <script src="src/imgdb.js"></script>
    <script>
        const urlobj = new URL(window.location.href)
        const parms = new URLSearchParams(urlobj.search)
        const display = document.getElementById("display");
        // hack
        const getID = () => {
            for (const [key, value] of parms) {
                if (key == "id") {
                    return value;
                }
            }
        }
        const displayItem = (id) => {
            if (!id) {
                display.innerHTML = "ID in parameter malformed";
                return;
            }
            let info = images.find((item => item.id === id))
            if (!info) {
                display.innerHTML = `no entry found for id ${id}`
                return;
            } else {
                let t = document.getElementById("slide-display");
                let clone = document.importNode(t.content, true);
                let par = clone.querySelector("p")
                if (info.description) {
                    par.innerHTML = info.description;
                    clone.querySelector(".slide-container").classList.add("two-rows")
                } else {
                    par.style.display = "none";
                    clone.querySelector(".slide-container").classList.add("one-row")
                }
                let img = clone.querySelector(".slide-container figure img");
                img.setAttribute("src", info.path)
                let caption = clone.querySelector(".slide-container figure figcaption");
                caption.innerHTML = info.caption;

                display.appendChild(clone);
            }
        }
        let id = getID();

        displayItem(id);
    </script>

</html>